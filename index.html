<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G1BACK Button</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }
        #frame-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f5f5f5;
        }
        #website-iframe {
            width: 100%;
            height: 100%;
            border: none;
            transition: opacity 0.3s ease;
        }
        #g1back-button {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 9999;
            padding: 14px 28px;
            background: linear-gradient(135deg, #FF5722 0%, #E91E63 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            display: none;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            opacity: 0;
            transform: translateY(20px);
        }
        #g1back-button.visible {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        #g1back-button:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        #g1back-button:active {
            transform: translateY(0) scale(0.98);
        }
    </style>
</head>
<body>
    <div id="frame-container">
        <iframe 
            id="website-iframe"
            src="https://www.jalwagame.win/#/register?invitationCode=57357202283"
            sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-top-navigation allow-storage-access-by-user-activation"
            allow="fullscreen"
            loading="eager">
        </iframe>
    </div>
    
    <button id="g1back-button">G1BACK</button>
    
    <script>
        const g1backButton = document.getElementById('g1back-button');
        const iframe = document.getElementById('website-iframe');
        
        // Ensure fullscreen display
        document.documentElement.style.height = '100%';
        document.body.style.height = '100%';
        iframe.style.height = '100%';
        
        // Start checking URL after iframe loads
        iframe.addEventListener('load', function() {
            checkCurrentPage();
            setInterval(() => {
                checkCurrentPage();
                monitorSrcChanges();
            }, 1000);
        });

        // Check current page URL - only show button when URL is exactly https://www.jalwawin5.com/#/
        function checkCurrentPage() {
            try {
                const iframeUrl = iframe.contentWindow.location.href;
                console.log('Current iframe URL:', iframeUrl);
                // Check for exact URL match - must be exactly https://www.jalwawin5.com/#/
                if (iframeUrl === 'https://www.jalwawin5.com/#/') {
                    showButton();
                } else {
                    hideButton();
                }
            } catch (e) {
                // Due to cross-origin restrictions, we can't access the iframe's current URL
                // We'll check if the iframe src matches our target URL exactly
                console.log('Checking iframe src:', iframe.src);
                // Only show button for exact match of https://www.jalwawin5.com/#/
                if (iframe.src === 'https://www.jalwawin5.com/#/') {
                    showButton();
                } else {
                    hideButton();
                }
            }
        }

        // Listen for messages from the iframe
        window.addEventListener('message', function(event) {
            if (event.origin !== 'https://www.jalwawin5.com') return;
            
            if (event.data.type === 'URL_CHANGE') {
                console.log('Received URL change:', event.data.url);
                if (event.data.url === 'https://www.jalwawin5.com/#/') {
                    showButton();
                } else {
                    hideButton();
                }
            } else if (event.data.type === 'SHOW_BUTTON') {
                console.log('Received show button message');
                showButton();
            } else if (event.data.type === 'HIDE_BUTTON') {
                console.log('Received hide button message');
                hideButton();
            }
        });

        // Alternative approach: Monitor iframe src changes
        let lastSrc = iframe.src;
        function monitorSrcChanges() {
            if (iframe.src !== lastSrc) {
                lastSrc = iframe.src;
                console.log('iframe src changed to:', lastSrc);
                // Only show button for exact URL match - must be exactly https://www.jalwawin5.com/#/
                if (lastSrc === 'https://www.jalwawin5.com/#/') {
                    showButton();
                } else {
                    hideButton();
                }
            }
        }

        // For testing - add a temporary function to change iframe to target URL
        // You can call this in browser console: testTargetURL()
        window.testTargetURL = function() {
            console.log('Changing iframe to target URL...');
            iframe.src = 'https://www.jalwawin5.com/#/';
            console.log('Changed iframe to target URL for testing');
        };
        
        // Function to simulate the jalwawin5.com domain for testing
        window.testJalwawin5 = function() {
            console.log('Simulating jalwawin5.com domain...');
            // Since jalwawin5.com blocks iframes, we'll simulate the URL check
            // This would normally be done by the iframe navigation
            const mockEvent = { data: { type: 'URL_CHANGE', url: 'https://www.jalwawin5.com/#/' } };
            if (mockEvent.data.url === 'https://www.jalwawin5.com/#/') {
                showButton();
                console.log('Button shown for jalwawin5.com/#/');
            }
        };

        // Add debug info
        console.log('Initial iframe src:', iframe.src);
        console.log('Target URL for button:', 'https://www.jalwawin5.com/#/');
        console.log('Call testTargetURL() in console to test button visibility');

        function showButton() {
            g1backButton.classList.add('visible');
        }

        function hideButton() {
            g1backButton.classList.remove('visible');
        }
        
        g1backButton.addEventListener('click', () => {
            g1backButton.style.background = "linear-gradient(135deg, #E91E63 0%, #FF5722 100%)";
            g1backButton.textContent = "Loading...";
            
            try {
                iframe.contentWindow.location.href = 'https://www.jalwawin5.com/#/register?invitationCode=863124778821';
            } catch (e) {
                try {
                    iframe.src = 'https://www.jalwawin5.com/#/register?invitationCode=863124778821';
                } catch (e) {
                    window.open('https://www.jalwawin5.com/#/register?invitationCode=863124778821', '_blank');
                }
            }
            
            setTimeout(() => {
                g1backButton.style.background = "linear-gradient(135deg, #FF5722 0%, #E91E63 100%)";
                g1backButton.textContent = "G1BACK";
            }, 2000);
        });
        
        iframe.addEventListener('error', () => {
            window.open('https://www.jalwagame.win/#/register?invitationCode=57357202283', '_blank');
        });
    </script>
</body>
</html>
